<?xml version="1.0"?>
<robot name="aibot_ketg" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Dummy Link to avoid KDL issue -->
  <link name="dummy_link">
    <visual>
      <geometry>
        <box size="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <box size="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>
  <joint name="fixed_dummy_joint" type="fixed">
    <parent link="dummy_link"/>
    <child link="0_Base_body_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <!-- Base Link -->
  <link name="0_Base_body_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/base_body.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/base_body.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="1.0"/>
      <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
    </inertial>
  </link>

  <!-- Astra2_1 Link -->
  <link name="Astra2_1_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_1.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_1.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Astra2_2 Link -->
  <link name="Astra2_2_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_2.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_2.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Astra2_3 Link -->
  <link name="Astra2_3_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_3.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra2_3.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Astra Embedded S Link -->
  <link name="Astra_Embedded_S_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra_embedded_s.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/astra_embedded_s.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Caster Back Left Link -->
  <link name="caster_back_left_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_back_left.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_back_left.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Caster Back Right Link -->
  <link name="caster_back_right_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_back_right.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_back_right.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Caster Front Left Link -->
  <link name="caster_front_left_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_front_left.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_front_left.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Caster Front Right Link -->
  <link name="caster_front_right_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_front_right.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/caster_front_right.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- MW-AHRSv1 IMU Link -->
  <link name="MW-AHRSv1_IMU_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/mw_ahrs_v1_imu.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/mw_ahrs_v1_imu.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- IMU Sensor -->
    <sensor name="imu_sensor" type="imu">
      <plugin name="imu_sensor_plugin" filename="libgazebo_ros_imu.so">
        <update_rate>50.0</update_rate>
        <robotNamespace>/imu</robotNamespace>
        <bodyName>MW-AHRSv1_IMU_link</bodyName>
        <topicName>imu</topicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 1 Link -->
  <link name="OCAM_1_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_1.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_1.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera1_sensor" type="camera">
      <plugin name="camera1_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera1</cameraName>
        <imageTopicName>camera1/image_raw</imageTopicName>
        <cameraInfoTopicName>camera1/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 2 Link -->
  <link name="OCAM_2_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_2.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_2.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera2_sensor" type="camera">
      <plugin name="camera2_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera2</cameraName>
        <imageTopicName>camera2/image_raw</imageTopicName>
        <cameraInfoTopicName>camera2/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 3 Link -->
  <link name="OCAM_3_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_3.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_3.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera3_sensor" type="camera">
      <plugin name="camera3_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera3</cameraName>
        <imageTopicName>camera3/image_raw</imageTopicName>
        <cameraInfoTopicName>camera3/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 4 Link -->
  <link name="OCAM_4_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_4.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_4.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera4_sensor" type="camera">
      <plugin name="camera4_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera4</cameraName>
        <imageTopicName>camera4/image_raw</imageTopicName>
        <cameraInfoTopicName>camera4/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 5 Link -->
  <link name="OCAM_5_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_5.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_5.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera5_sensor" type="camera">
      <plugin name="camera5_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera5</cameraName>
        <imageTopicName>camera5/image_raw</imageTopicName>
        <cameraInfoTopicName>camera5/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- OCAM 6 Link -->
  <link name="OCAM_6_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_6.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/ocam_6.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Camera Sensor -->
    <sensor name="camera6_sensor" type="camera">
      <plugin name="camera6_sensor_plugin" filename="libgazebo_ros_camera.so">
        <alwaysOn>true</alwaysOn>
        <updateRate>30</updateRate>
        <cameraName>camera6</cameraName>
        <imageTopicName>camera6/image_raw</imageTopicName>
        <cameraInfoTopicName>camera6/camera_info</cameraInfoTopicName>
      </plugin>
    </sensor>
  </link>

  <!-- TiM571 Link -->
  <link name="TiM571_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/tim571.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/tim571.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
    <!-- Lidar Sensor -->
    <sensor name="lidar_sensor" type="ray">
      <plugin name="lidar_sensor_plugin" filename="libgazebo_ros_laser.so">
        <topicName>lidar</topicName>
        <frameName>TiM571_link</frameName>
        <min_range>0.1</min_range>
        <max_range>10.0</max_range>
        <update_rate>10.0</update_rate>
        <horizontal_samples>720</horizontal_samples>
        <horizontal_resolution>1.0</horizontal_resolution>
        <horizontal_max_angle>1.5708</horizontal_max_angle>
        <horizontal_min_angle>-1.5708</horizontal_min_angle>
      </plugin>
    </sensor>
  </link>

  <!-- Wheel Left Link -->
  <link name="wheel_L_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/wheel_l.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/wheel_l.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Wheel Right Link -->
  <link name="wheel_R_link">
    <visual>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/wheel_r.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </visual>
    <collision>
      <geometry>
        <mesh filename="package://ketg_description/meshes/stl/wheel_r.stl" scale="0.01 0.01 0.01"/>
      </geometry>
    </collision>
  </link>

  <!-- Joints -->
  <joint name="astra2_1_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="Astra2_1_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="astra2_2_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="Astra2_2_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="astra2_3_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="Astra2_3_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="astra_embedded_s_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="Astra_Embedded_S_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="caster_back_left_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="caster_back_left_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="caster_back_right_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="caster_back_right_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="caster_front_left_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="caster_front_left_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="caster_front_right_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="caster_front_right_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="1.5708 0 0"/>
  </joint>

  <joint name="mw_ahrs_v1_imu_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="MW-AHRSv1_IMU_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_1_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_1_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_2_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_2_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_3_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_3_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_4_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_4_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_5_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_5_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="ocam_6_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="OCAM_6_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="tim571_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="TiM571_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="wheel_l_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="wheel_L_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <joint name="wheel_r_joint" type="fixed">
    <parent link="0_Base_body_link"/>
    <child link="wheel_R_link"/>
    <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
  </joint>

  <!-- Differential Drive Controller -->
  <gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so"/>
  </gazebo>

  <gazebo>
    <plugin name="joint_states" filename="libgazebo_ros_joint_state_publisher.so">
      <joint_name>wheel_l_joint</joint_name>
      <joint_name>wheel_r_joint</joint_name>
      <updateRate>100</updateRate>
    </plugin>

    <plugin name="base_controller" filename="libgazebo_ros_diff_drive.so">
      <commandTopic>cmd_vel</commandTopic>
      <odometryTopic>robot/odom</odometryTopic>
      <odometryFrame>odom</odometryFrame>
      <odometrySource>world</odometrySource>
      <publishOdomTF>true</publishOdomTF>
      <robotBaseFrame>0_Base_body_link</robotBaseFrame>
      <publishWheelTF>false</publishWheelTF>
      <publishTf>true</publishTf>
      <publishWheelJointState>true</publishWheelJointState>
      <legacyMode>false</legacyMode>
      <updateRate>30</updateRate>
      <leftJoint>wheel_l_joint</leftJoint>
      <rightJoint>wheel_r_joint</rightJoint>
      <wheelSeparation>0.347</wheelSeparation>
      <wheelDiameter>0.130</wheelDiameter>
      <wheelAcceleration>1</wheelAcceleration>
      <wheelTorque>10</wheelTorque>
      <rosDebugLevel>na</rosDebugLevel>
    </plugin>
  </gazebo>
</robot>

